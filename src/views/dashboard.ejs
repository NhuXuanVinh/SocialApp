<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Dashboard</title>
    <link rel="stylesheet" href="/css/dashboard.css">
    <script>
        // Function to show alert
        function showAlert(message, type) {
            const alertBox = document.createElement('div');
            alertBox.className = `alert alert-${type}`;
            alertBox.textContent = message;
            document.body.prepend(alertBox);

            // Automatically close the alert after 3 seconds
            setTimeout(() => {
                alertBox.remove();
            }, 10000);
        }

        // Function to show alerts from server-side flash messages
        function showFlashMessages() {
            const successMessage = "<%= messages.success && messages.success.length > 0 ? messages.success[0] : '' %>";
            const errorMessage = "<%= messages.error && messages.error.length > 0 ? messages.error[0] : '' %>";

            if (successMessage) {
                showAlert(successMessage, 'success');
            }

            if (errorMessage) {
                showAlert(errorMessage, 'danger');
            }
        }

        // Execute the function when the page loads
        window.onload = showFlashMessages;
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Social Media Dashboard</h1>
        </header>
        <section class="accounts">
            <h2>Connected Accounts</h2>
            <ul class="account-list">
                <li>
                    <div class="account linkedin">
                        <% if (linkedinAccounts && linkedinAccounts.length > 0) { %>
                            <% linkedinAccounts.forEach(account => { %>
                                <div class="account-item">
                                    <img src="/images/linkedin.png" alt="LinkedIn">
                                    <span>Connected as <%= account.username %></span>
                                    <a href="/post-to-linkedin/<%= account.linkedin_id %>" class="reconnect">Post</a>
                                </div>
                            <% }) %>
                        <% } %>
                    </div>
                </li>
                <li>
                    <div class="account twitter">
                        <% if (twitterAccounts && twitterAccounts.length > 0) { %>
                            <% twitterAccounts.forEach(account => { %>
                                <div class="account-item">
                                    <img src="/images/twitter.png" alt="Twitter">
                                    <span>Connected as <%= account.username %></span>
                                    <a href="/tweet/<%= account.twitter_id %>" class="reconnect">Post</a>
                                </div>
                            <% }) %>
                        <% } %>
                    </div>
                </li>
            </ul>
        </section>

        <section class="post">
            <h2>Connect to your social accounts</h2>
            <ul class="account-list">
                <li>
                    <div class="account linkedin">
                        <div class="account-item">
                            <img src="/images/linkedin.png" alt="LinkedIn">
                            <span>Connect to Linkedin</span>
                                <a href="/auth/linkedin" class="connect">Connect</a>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="account twitter">
                        <div class="account-item">
                            <img src="/images/twitter.png" alt="Twitter">
                            <span>Connect to Twitter</span>
                            <a href="/auth/twitter" class="connect">Connect</a>
                        </div>
                    </div>
                </li>
            </ul>
        </section>
    </div>
</body>
</html>
